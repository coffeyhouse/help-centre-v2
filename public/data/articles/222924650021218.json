{
  "author": "sageadmin",
  "approver": "angie.gwalchmai@sage.com",
  "attributeSetName": null,
  "attributes": [],
  "categoryCode": "custom",
  "collections": [
    "custom_au_en_threehundredcre",
    "custom_ca_threehundred_construction",
    "custom_us_threehundred_construction"
  ],
  "createDate": 1646225552000,
  "diagnosticResponses": [],
  "fields": [
    {
      "name": "Description",
      "content": ""
    },
    {
      "name": "Cause",
      "content": "<div style=\"font-family: Arial, Verdana, sans-serif; font-size: 14px;\"> <p>MyAssistant Tasks can fail to finish running for one or more of the following reasons:</p> <ul> <li>The ISDAdminTaskService service is not running or needs to be restarted on the MyAssistant Server</li> <li>Antivirus or Firewall is disabling or killing the ISDAdminSenderService</li> <li>The ISDAdminTaskService does not have sufficient permissions to run <ul> <li>The Windows services ISDAdminTaskService and ISDAdminSenderService run as a Local System account by default on the MyAssistant Server. The Local System account may not always have the permissions required for the MyAssistant software to run properly.</li> </ul> </li> <li>MyAssistant Server is not activated or cannot reactivate <ul> <li>MyAssistant attempts to contact the entitlements about every 30 days. If the attempt fails due to any number of reasons (such as a firewall, proxy server, or antivirus software), MyAssistant deactivates.</li> </ul> </li> <li>The MyAssistant Drive Mapper must be upgraded <ul> <li>This will be indicated by errors that will be found in the Event Viewer on the MyAssistant Server.</li> </ul> </li> <li>Insufficient permissions to the registry <ul> <li>Event Viewer may show this error:<br><strong>Source: ApplicationCoreServices.Security.ActivationHelper.UpdateReportingStatistics<br>Process ID: 2992</strong> <strong>Unable to update service statistics: invalid activation data.<br>System.UnauthorizedAccessException: Access to the registry key HKEY_LOCAL_MACHINE\\Software\\Innovative Software Design\\My Assistant\\Setup Information' is denied.</strong></li> </ul> </li> <li>There are multiple MyAssistant servers currently active. <ul> <li>This is typically caused by a performing a migration and not disabling MyAssistant on the old server.</li> </ul> </li> <li>The ntdbsmgr process on the server is using too many resources and interfering with MyAssistant's communication with Pervasive. <ul> <li>This will be specific to versions 16.1 and higher.</li> <li>This is due to the Actian/Pervasive engine not being configured with the most optimal settings.</li> </ul> </li> <li>Regional settings on the server are incorrect. Windows Regional settings is set to USA and CRE install is configured for Canada, or vice versa <ul> <li>You may receive the following error message in the System Information log:&nbsp;<br>\"An error occurred while updating the server statistics System.ArgumentOutOfRangeException: The added or subtracted value results in an un-representable DateTime. Parameter name: value at System.DateTime.AddTicks(Int64 value) at System.DateTime.Add(Double value, Int32 scale) at TaskCommand.TaskCommand.Execute(ObjectstaticData)\"</li> </ul> </li> </ul> </div>"
    },
    {
      "name": "Resolution",
      "content": "<p></p><span class=\"ra-content-caution-1 mceNonEditable\" style=\"color: #b94a48;\"><span><img class=\"ra-att-img\" src=\"https://internal-kb.sage.com/portal/app/images/content_caution.gif\" alt=\"\" width=\"18px\" height=\"17px\" />&nbsp;<strong class=\"ra-att-title\">CAUTION:</strong> This solution requires advanced knowledge of Windows security and network settings. Sage isn't responsible for any issues that arise from changes to these settings. Ensure you back up all system and application databases necessary for a complete restoration. It's advisable to contact a certified consultant or your system administrator for assistance.</span></span><p>&nbsp;</p><ul> <li><u>Start or Restart the ISDAdminTaskService on the server:</u> <ul> <li><u>For all versions:</u> <ol> <li>Log on to the MyAssistant server as a Windows administrator.</li> <li>Click the Windows <strong>Start</strong> button and type <strong>Services</strong> into the <strong>Search</strong> bar.</li> <li>Select the Windows <strong>Services</strong> program from the list of results.</li> <li>Locate <strong>ISDAdminTaskService</strong>.</li> <li>Right-click on the service and select <strong>Restart</strong>.<br><strong>Note:</strong> If you receive a 1053 error, see [[Error: \"1053: The service did not respond...\" when starting the ISDAdminTaskService for MyAssistant|240822233921990]]&nbsp;</li> <li>Try to re-run the task.</li> </ol> </li> <li><u>For only versions 20.3.5 and later:</u> <ol> <li>Launch the <strong>MyAssistant Designer</strong>.</li> <li>Go to <strong>File</strong>, <strong>Restart Run and Send</strong>.</li> <li>Click <strong>OK</strong> to pop up message and wait the suggested time.</li> </ol> </li> </ul> </li> <li><u>Set anti-virus or firewall exclusions for MyAssistant files:</u> <ul> <li>See [[Sage MyAssistant and MyCommunicator anti-virus and firewall exceptions.|222924750023771]]</li> </ul> </li> <li><u>Update the ISDAdminTaskService and ISDAdminSenderService to run as a Windows domain administrator:</u> <ol> <li>Log on to the MyAssistant server as a Windows administrator.</li> <li>Click the Windows <strong>Start</strong> button and type <strong>Services</strong> into the <strong>Search</strong> bar.</li> <li>Select the Windows <strong>Services</strong> program from the list of results.</li> <li>Locate the <strong>ISDAdminTaskService</strong> and <strong>ISDAdminSenderService</strong> and double-click on each to open the properties window.</li> <li>Click the <strong>Log On</strong> tab.</li> <li>In the <strong>This account</strong> field, if you know the domain, type in an administrator account, such as MyDomain\\Administrator where MyDomain is whatever your network domain is. This account cannot be a local administrator account, and must belong to the domain. If you know the domain and type in the correct <strong>[domain]\\[username]</strong> account, skip the remaining steps and simply click <strong>OK</strong> and restart both ISD services.</li> <li>If you do not know what the domain is, click <strong>Browse</strong>.</li> <li>In the next window, click<strong> Locations</strong>, <strong>Entire Directory</strong>.</li> <li>Highlight your domain.</li> <li>Click <strong>OK</strong>.</li> <li>In the <strong>Enter the object name to select</strong> window, type in the username and click <strong>Check Names</strong>.</li> <li>Select the correct username if prompted.</li> <li>Click <strong>OK</strong> twice.</li> <li>Restart both ISD services.</li> </ol> </li> <li><u>Reactivate the MyAssistant Server:</u> <ol> <li>Log on the server as the Windows user who originally activated the MyAssistant Server.<br><strong>Note:</strong> When you activate any license key, it is linked to that Computer name and Windows user login. You must remember which login you used to perform this step. If you do not know, contact Sage Support.</li> <li>Launch <strong>MyAssistant Configuration Manager</strong>.</li> <li>Click on <strong>Reactivate</strong> or <strong>Activate</strong> if given the button to do so. If this fails, contact Sage Support.</li> </ol> </li> <li><u>Upgrade the MyAssistant Drive Mapper:<br></u><strong>Note:</strong> These steps require knowledge of your network and file locations, and should be performed by a Windows user with Administrative rights to your server.<u><br></u> <ol> <li>Log on to the MyAssistant server with a Windows user that has Administrator or Unlimited privileges.</li> <li>Stop the <strong>ISDAdminTaskService</strong> and <strong>ISDAdminSenderService</strong> services from Window Services.</li> <li>Open the <strong>Tools</strong> folder from the extracted MyAssistant installation files. This will be a location you selected when saving the install files. There is no default location.</li> <li>Open the <strong>DriveMapperCommand.config</strong> file with a text editor.</li> <li>Replace the drive letter and UNC path with your mapped network drives used for reporting and file locations.</li> <li>Using Windows Explorer, copy the <strong>InnovativeSoftwareDesign.MyAssistant.DriveMapperCommand.dll</strong> file and the <strong>DriveMapperCommand.config</strong> file.</li> <li>Paste both files in the following locations: <ul> <li>C:\\Program Files (x86)\\Innovative Software Design\\MyAssistant</li> <li>C:\\Program Files (x86)\\Innovative Software Design\\MyAssistant\\Sender Service</li> <li>C:\\Program Files (x86)\\Innovative Software Design\\MyAssistant\\Task Service<br><strong>Note:</strong> The default location for MyAssistant installation is \"C:\\Program Files (x86)\\Innovative Software Design\\MyAssistant\". Use your custom location if you changed the path during installation.</li> </ul> </li> <li><span style=\"letter-spacing: 0.2px;\">Start the </span><strong style=\"font-size: 11pt; letter-spacing: 0.2px;\">ISDAdminTaskService</strong><span style=\"letter-spacing: 0.2px;\"> and </span><strong style=\"font-size: 11pt; letter-spacing: 0.2px;\">ISDAdminSenderService</strong><span style=\"letter-spacing: 0.2px;\">&nbsp;from Windows Services.</span></li> <li>The MyAssistant Drive Mapper tool is now upgraded.</li> </ol> </li> <li><u>Modify permissions to registry key:</u> <ol> <li>Give full permissions to the <strong>HKEY_LOCAL_MACHINE\\Software\\Wow6432Node\\Innovative Software Design\\</strong> registry key to the groups for the MyAssistant operators and Service accounts.</li> <li>Restart the<strong> ISDAdminTaskService</strong> and<strong> ISDAdminSenderService</strong> services.</li> </ol> </li> <li><u>Disable old server and update workstation configuration:</u> <ol> <li>Connect to old server.</li> <li>Launch Windows <strong>Services</strong>.</li> <li>Stop the <strong>ISDAdminSender</strong>, <strong>ISDAdminTask</strong> and <strong>SQL Server (ISD)</strong> services.</li> <li>Disable all three services by right-clicking and selecting <strong>Properties</strong>.</li> <li>Launch MyAssistant Designer on the workstation.</li> <li>You should be prompted to correct the <strong>SQL Server</strong> name. Click <strong>OK</strong> to this message and it will launch the user configuration.</li> <li>Update the server name.</li> <li>Click <strong>OK</strong> to save settings.</li> </ol> </li> <li><u>Change the Actian/Pervasive engine settings:</u> <ol> <li>See [[The ntdbsmgr.exe or PSQL Component processes are using too many resources.|224924150049707]] for the recommended settings.</li> <li>Changing these settings will require a restart of the Actian/Pervasive engine, so all users should be out of Sage 300 Construction and Real Estate.</li> <li>After the Actian/Pervasive engine is restarted, restart both ISD services.</li> </ol> </li> <li><span style=\"text-decoration: underline;\">Change the Windows Regional Settings on the server to match the 300CRE installation:</span> <ul> <li>See [[Error: \"Application does not match country currently selected\" after installing Windows updates (Country registry key)|223924250030760]]</li> </ul> </li> </ul><div class=\"col-xs-12 col-sm-7\"><p style=\"margin-bottom: 8px;\"></p> </div><p>&nbsp;</p><div class=\"col-xs-12 col-sm-7\"> <h4>Need more help?</h4> <p style=\"margin-bottom: 8px;\"><a id=\"limitless-url\" class=\"btn btn-primary\" style=\"color: white; background-color: black; border: black; border-radius: 24px; margin-top: 8px; width: 40%;\" rel=\"noopener\" href=\"https://www.sage300construction.com/chat\" target=\"_blank\">Chat now</a></p> </div><div class=\"mce-visual-caret mce-visual-caret-before mce-visual-caret-hidden\" data-mce-bogus=\"all\" style=\"inset: -0.234375px -2px 64.7656px; width: 1px; height: 65px;\"></div>"
    },
    {
      "name": "Steps to duplicate",
      "content": ""
    },
    {
      "name": "Related Solutions",
      "content": "<p>[[Create a Windows Scheduled Task to restart MyAssistant services.|222924450019753]]<br style=\"font-size: 14.6667px; letter-spacing: 0.2px;\">[[MyAssistant Required Permissions.|222924450019804]]<br style=\"font-size: 14.6667px; letter-spacing: 0.2px;\">[[Required permissions for Windows account assigned to MyAssistant services.|222924550020834]]<br style=\"font-size: 14.6667px; letter-spacing: 0.2px;\">[[ï»¿Why are my ISD windows services missing on the server after upgrading MyAssistant?|224924650065523]]<br style=\"font-size: 14.6667px; letter-spacing: 0.2px;\"></p>"
    }
  ],
  "id": "222924650021218",
  "language": "English",
  "lastModifiedDate": 1646225552000,
  "minorModifiedDate": 1724370056000,
  "keywords": "MYA",
  "question": null,
  "renewDate": 1715126400000,
  "solutionBoost": 1.0,
  "status": "Published",
  "type": "Template Solution",
  "taxonomy": [
    "Category//Performance//Connectivity//Product"
  ],
  "templateName": "1 - Support Article",
  "title": "MyAssistant tasks run, but never complete. (multiple causes)",
  "translations": [],
  "viewCount": 976,
  "solvedCount": 101,
  "unsolvedCount": 0,
  "summary": "The MyAssistant task appears to keep running without completion. There are no errors on the screen, although there may be errors in the Event Viewer. There are no notifications generated and no emails are sent or received.",
  "revisionID": null,
  "templateSolutionID": "PRE2157785"
}